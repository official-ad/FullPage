<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Wonbet.vip ‚Äì Crea tu usuario</title>

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap"
    rel="stylesheet"
  />
  <!-- Lottie Player -->
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <!-- Stylesheet -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Meta Pixel -->
  <script>
    const PIXEL_ID = '1391288831895635';
    !function(f,b,e,v,n,t,s){
      if(f.fbq) return; n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq) f._fbq=n; n.push=n; n.loaded=!0; n.version='2.0';
      n.queue=[]; t=b.createElement(e); t.async=!0;
      t.src=v; s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s);
    }(window, document, 'script',
      'https://connect.facebook.net/en_US/fbevents.js'
    );
    fbq('init', PIXEL_ID);
    fbq('track', 'ViewContent');
  </script>
</head>
<body>
  <!-- Preloader Overlay -->
  <div id="preloader">
    <lottie-player
      src="videos/slot-machine.json"
      background="transparent"
      speed="1"
      style="width:150px; height:150px;"
      autoplay
      loop
    ></lottie-player>
  </div>

  <!-- Theme Toggle -->
  <button id="themeToggle" class="theme-toggle">üåô</button>

  <!-- Screen √öNICA -->
  <div class="screen">
    <!-- Form Card -->
    <div class="card">
      <div class="logo">
        <img src="images/logo.png" alt="Logo de Wonbet.vip" />
      </div>
      <h1 class="title">200% EXTRA</h1>
      <h1 class="title">EN TU CARGA</h1>
      <p class="subtitle">
        <span class="fire">üî•</span>
        ESCRIB√ç TU NOMBRE Y CREA TU USUARIO
        <span class="fire">üî•</span>
      </p>
      <p class="highlight">SIN LIMITE DE RETIRO</p>
      <div class="input-group">
        <input
          type="text"
          id="username"
          placeholder="ESCRIBI TU NOMBRE"
          autocomplete="off"
        />
      </div>
      <a href="#" id="ctaButton" class="btn">
        ¬°CREA TU USUARIO!
        <img src="images/whatsapp-icon.svg" alt="WhatsApp icon" class="icon" />
      </a>
    </div>

    <!-- Testimonials Section -->
    <section class="testimonials-section">
      <h2>FEEDBACK</h2>
      <div class="testimonials-carousel" id="testimonialsCarousel">
        <!-- testimonials-carousel.js inyecta los items aqu√≠ -->
      </div>
    </section>

    <!-- Cubo 3D (las caras tomar√°n las im√°genes) -->
    <div class="scene">
      <div class="shadow"></div>
      <div class="container">
        <div class="face front"><img src="" alt="Front face" /></div>
        <div class="face back"><img src="" alt="Back face" /></div>
        <div class="face right"><img src="" alt="Right face" /></div>
        <div class="face left"><img src="" alt="Left face" /></div>
        <div class="face top"><img src="" alt="Top face" /></div>
        <div class="face bottom"><img src="" alt="Bottom face" /></div>
      </div>
    </div>
  </div>

  <!-- Fallback Mobile Content -->
  <main class="content">
    <section class="info">
      <h2>¬øPor qu√© Mega Cash?</h2>
      <p>Con Wonbet.vip viv√≠s la emoci√≥n de un casino en la palma de tu mano. Bono de bienvenida, retiros inmediatos y soporte 24/7.</p>
    </section>
  </main>

  <!-- Funciones: Preloader, Theme Toggle, CTA Button, y payload/API/WhatsApp -->
  <script>
    const API_URL = 'https://jxfyydlcu7.execute-api.us-east-2.amazonaws.com/prod/Capture_fbc';
    const whatsappNumbers = [
      '5491125737314','5491178446299','5491171836710','5491169771768',
      '5491162557202','5491125730166','5491178446277','5491178466845',
      '5491171635226','5491178467850','5491171635973','5491171833570',
      '5491178466905','5491171833569'
    ];
    const mensajeBase = 'Hola vengo por el 200%!';

    function parseCookies() {
      return document.cookie
        .split('; ')
        .reduce((c, kv) => {
          const [name, ...v] = kv.split('=');
          c[name] = v.join('=');
          return c;
        }, {});
    }

    function generateUUID() {
      const bytes = new Uint8Array(16);
      crypto.getRandomValues(bytes);
      return Array.from(bytes)
        .map(b => b.toString(16).padStart(2,'0'))
        .join('');
    }

    function waitForCookie(name, timeout = 3000) {
      return new Promise(res => {
        const interval = 100;
        let waited = 0;
        const timer = setInterval(() => {
          if (document.cookie.split('; ').some(c => c.startsWith(name + '=')) || waited >= timeout) {
            clearInterval(timer);
            res();
          }
          waited += interval;
        }, interval);
      });
    }

    // Preloader
    window.addEventListener('load', () => {
      const pre = document.getElementById('preloader');
      pre.style.opacity = 0;
      setTimeout(() => pre.remove(), 600);
    });

    // Theme Toggle
    const toggle = document.getElementById('themeToggle');
    toggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('light');
      toggle.textContent = document.documentElement.classList.contains('light') ? 'üåû' : 'üåô';
    });

    // CTA Button: env√≠o al API y redirecci√≥n a WhatsApp
    document.getElementById('ctaButton').addEventListener('click', async e => {
      e.preventDefault();
      const name = document.getElementById('username').value.trim();
      if (!name) {
        const inp = document.getElementById('username');
        inp.classList.add('shake');
        setTimeout(() => inp.classList.remove('shake'), 500);
        return;
      }

      const id = generateUUID();
      const textoCompleto = `${mensajeBase} Mi c√≥digo promocional es: ${id}%0AEste es mi nombre: ${encodeURIComponent(name)}`;
      await Promise.all([ waitForCookie('_fbc'), waitForCookie('_fbp') ]);
      const cookies = parseCookies();
      const payload = {
        event:     'ViewContent',
        timestamp: new Date().toISOString(),
        _fbc:      cookies._fbc || null,
        _fbp:      cookies._fbp || null,
        id
      };
      fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      }).catch(() => {}).finally(() => {
        const num = whatsappNumbers[Math.floor(Math.random() * whatsappNumbers.length)];
        window.location.href = `https://wa.me/${num}?text=${textoCompleto}`;
      });
    });
  </script>

  <!-- Script para rotar las 14 im√°genes en las 6 caras -->
  <script>
    const slideImages = [
      'images/slide1.jpg','images/slide2.jpg','images/slide3.jpg','images/slide4.jpg',
      'images/slide5.jpg','images/slide6.jpg','images/slide7.jpg','images/slide8.jpg',
      'images/slide9.jpg','images/slide10.jpg','images/slide11.jpg','images/slide12.jpg',
      'images/slide13.jpg','images/slide14.jpg'
    ];
    const faceImgs = Array.from(document.querySelectorAll('.scene .face img'));
    let startIndex = 0;

    function rotateCubeFaces() {
      faceImgs.forEach((imgEl, i) => {
        imgEl.src = slideImages[(startIndex + i) % slideImages.length];
      });
      startIndex = (startIndex + 1) % slideImages.length;
    }

    rotateCubeFaces();
    setInterval(rotateCubeFaces, 3000);
  </script>

  <!-- Testimonials carousel JS -->
  <script src="testimonials-carousel.js"></script>
</body>
</html>
